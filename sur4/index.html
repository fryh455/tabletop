<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SUR4 Tabletop MVP</title>
  <link rel="stylesheet" href="./assets/styles.css" />
</head>
<body>
  <div id="app">
    <header id="topbar">
      <div id="brand">SUR4 Tabletop (MVP)</div>
      <div id="session-badge"></div>
      <div id="topbar-actions">
        <button id="btn-copy-link" type="button">Copiar link</button>
        <button id="btn-export" type="button">Exportar JSON</button>
        <label class="btn-like" for="import-file">Importar JSON</label>
        <input id="import-file" type="file" accept="application/json" />
        <button id="btn-switch-user" type="button">Trocar usuário</button>
      </div>
    </header>

    <main id="main">
      <section id="canvas-pane">
        <div id="canvas-toolbar">
          <button id="btn-add-token" type="button">+ Token</button>
          <button id="btn-snap" type="button" data-on="0">Snap: OFF</button>
          <button id="btn-zoom-reset" type="button">Zoom 100%</button>
          <div id="hint">Arraste tokens. Scroll = zoom. Espaço + arrastar = pan.</div>
        </div>
        <canvas id="tabletop-canvas" width="1200" height="800"></canvas>
      </section>

      <aside id="side-pane">
        <div class="tabs">
          <button class="tab" data-tab="sheets" aria-selected="true">Fichas</button>
          <button class="tab" data-tab="inspector">Inspector</button>
          <button class="tab" data-tab="players">Players</button>
        </div>

        <div id="tab-sheets" class="tab-panel">
          <div id="sheets-actions">
            <button id="btn-create-sheet" type="button">+ Criar ficha</button>
          </div>
          <div id="sheets-list"></div>
          <div id="sheet-view"></div>
        </div>

        <div id="tab-inspector" class="tab-panel hidden">
          <div id="inspector-empty">Selecione um token.</div>
          <div id="inspector"></div>
        </div>

        <div id="tab-players" class="tab-panel hidden">
          <div id="players-list"></div>
          <div class="muted">Obs: sem sync real no MVP (lista local).</div>
        </div>
      </aside>
    </main>
  </div>

  <!-- AUTH MODAL (BLOCKING) -->
  <div id="modal-auth" class="modal-overlay" aria-hidden="false">
    <div class="modal">
      <h2>Entrar na mesa</h2>
      <p class="muted">Sem salvar estado. Ao recarregar, precisa entrar de novo.</p>
      <div class="form-row">
        <label for="auth-name">Nome</label>
        <input id="auth-name" type="text" maxlength="24" placeholder="Seu nome" autocomplete="off" />
      </div>
      <div class="form-row">
        <label for="auth-role">Função</label>
        <select id="auth-role">
          <option value="player">Jogador</option>
          <option value="master">Mestre</option>
        </select>
      </div>
      <div class="form-row">
        <button id="auth-submit" type="button">Entrar</button>
      </div>
      <p class="muted small">Room: <span id="auth-room-id"></span></p>
    </div>
  </div>

  <!-- ROLL MODAL -->
  <div id="modal-roll" class="modal-overlay hidden" aria-hidden="true">
    <div class="modal">
      <h2>Rolagem</h2>
      <div id="roll-summary"></div>
      <div class="form-row">
        <button id="roll-close" type="button">Fechar</button>
      </div>
    </div>
  </div>

  <!-- TOKEN MODAL -->
  <div id="modal-token" class="modal-overlay hidden" aria-hidden="true">
    <div class="modal">
      <h2>Novo token</h2>
      <p class="muted">Imagem será salva em Base64 (DataURL) no estado local.</p>
      <div class="form-row">
        <label for="token-owner">Dono (opcional)</label>
        <input id="token-owner" type="text" maxlength="24" placeholder="Nome do jogador (ou vazio)" autocomplete="off" />
      </div>
      <div class="form-row">
        <label for="token-size">Tamanho (px)</label>
        <input id="token-size" type="number" min="24" max="256" step="1" value="64" />
      </div>
      <div class="form-row">
        <label for="token-file">Imagem</label>
        <input id="token-file" type="file" accept="image/*" />
      </div>
      <div class="form-row">
        <button id="token-create" type="button">Criar</button>
        <button id="token-cancel" type="button" class="secondary">Cancelar</button>
      </div>
    </div>
  </div>

  <!-- SHEET MODAL -->
  <div id="modal-sheet" class="modal-overlay hidden" aria-hidden="true">
    <div class="modal">
      <h2>Criar ficha</h2>
      <div class="form-row">
        <label for="sheet-name">Nome</label>
        <input id="sheet-name" type="text" maxlength="32" placeholder="Nome do personagem" autocomplete="off" />
      </div>
      <div class="form-row">
        <label for="sheet-owner">Dono (player)</label>
        <input id="sheet-owner" type="text" maxlength="24" placeholder="Nome do jogador" autocomplete="off" />
      </div>
      <div class="grid-attrs">
        <div class="form-row">
          <label for="attr-qi">QI</label>
          <input id="attr-qi" type="number" min="-2" max="6" value="1" />
        </div>
        <div class="form-row">
          <label for="attr-for">FOR</label>
          <input id="attr-for" type="number" min="-2" max="6" value="1" />
        </div>
        <div class="form-row">
          <label for="attr-dex">DEX</label>
          <input id="attr-dex" type="number" min="-2" max="6" value="1" />
        </div>
        <div class="form-row">
          <label for="attr-vig">VIG</label>
          <input id="attr-vig" type="number" min="-2" max="6" value="1" />
        </div>
      </div>
      <div class="form-row">
        <label for="sheet-notes">Notas</label>
        <textarea id="sheet-notes" rows="4" maxlength="800" placeholder="Notas curtas..."></textarea>
      </div>
      <div class="form-row">
        <button id="sheet-create" type="button">Criar</button>
        <button id="sheet-cancel" type="button" class="secondary">Cancelar</button>
      </div>
    </div>
  </div>

  <script type="module" src="./src/main.js"></script>
</body>
</html>
